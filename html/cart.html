<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Coșul tău de cumpărături la Leyr. - Printare 3D profesională pentru figurine, cercei și bijuterii">
<title>Leyr. — Coș</title>
<link rel="icon" href="../imgages/logo3.ico">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="../css/cart.css">
</head>
<body>

<header>
  <img src="../imgages/logo1.png" alt="Leyr." onclick="window.location.href='index.html'">
  <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle menu">
    <span></span>
    <span></span>
    <span></span>
  </button>
  <nav id="navMenu">
    <a href="index.html">Acasă</a>
    <a href="catalogue.html">Produsele Noastre</a>
    <a href="services.html">Serviciile Noastre</a>
    <a href="contact.html">Contactează-ne</a>
    <a href="cart.html">Coș</a>
  </nav>
</header>

<section class="cart-container">
  <h2 class="cart-title">Your Cart</h2>
  <div id="cartItems"></div>
  <div id="emptyMsg" class="empty-cart" style="display: none;">
    Your cart is empty.
    <button onclick="window.location.href='catalogue.html'">Shop Now!</button>
  </div>
  <div id="cartSummary" class="cart-summary" style="display: none;">
    <div class="summary-row">
      <span>Subtotal:</span>
      <span id="subtotal">$0.00</span>
    </div>
    <div class="summary-row total">
      <span>Total:</span>
      <span id="total">$0.00</span>
    </div>
    <button id="checkoutBtn" class="checkout-btn">Checkout via WhatsApp</button>
  </div>
</section>

<script>
const mobileMenuToggle = document.getElementById('mobileMenuToggle');
const navMenu = document.getElementById('navMenu');

if (mobileMenuToggle) {
  mobileMenuToggle.addEventListener('click', () => {
    navMenu.classList.toggle('active');
  });
  
  // Close menu when clicking on a link (mobile)
  const navLinks = navMenu.querySelectorAll('a');
  navLinks.forEach(link => {
    link.addEventListener('click', () => {
      if (window.innerWidth <= 768) {
        navMenu.classList.remove('active');
      }
    });
  });
}

// CART LOGIC
let cart = [];

// Load cart from localStorage with error handling
try {
  const cartData = localStorage.getItem('cart');
  cart = cartData ? JSON.parse(cartData) : [];
  // Ensure cart items have required properties
  cart = cart.map(item => ({
    name: item.name || 'Unknown Product',
    price: item.price || 0,
    img: item.img || 'placeholder.jpg',
    qty: item.qty || 1
  }));
} catch (error) {
  console.error('Error loading cart:', error);
  cart = [];
}

const cartItemsDiv = document.getElementById('cartItems');
const emptyMsg = document.getElementById('emptyMsg');
const cartSummary = document.getElementById('cartSummary');
const checkoutBtn = document.getElementById('checkoutBtn');

function saveCart() {
  try {
    localStorage.setItem('cart', JSON.stringify(cart));
  } catch (error) {
    console.error('Error saving cart:', error);
    alert('Unable to save cart. Please try again.');
  }
}

function renderCart() {
  cartItemsDiv.innerHTML = '';
  
  if (cart.length === 0) {
    emptyMsg.style.display = 'block';
    cartSummary.style.display = 'none';
    return;
  }
  
  emptyMsg.style.display = 'none';
  cartSummary.style.display = 'block';
  
  let subtotal = 0;
  
  cart.forEach((item, index) => {
    const itemTotal = (item.price || 0) * (item.qty || 1);
    subtotal += itemTotal;
    
    const div = document.createElement('div');
    div.className = 'cart-item';
    div.innerHTML = `
      <img src="${item.img || 'placeholder.jpg'}" alt="${item.name}" onerror="this.src='placeholder.jpg'">
      <div class="cart-item-details">
        <h3>${item.name}</h3>
        <div class="cart-item-price">$${(item.price || 0).toFixed(2)} each</div>
        <div class="qty-controls">
          <button class="dec" aria-label="Decrease quantity">-</button>
          <span>${item.qty || 1}</span>
          <button class="inc" aria-label="Increase quantity">+</button>
        </div>
      </div>
      <button class="remove-item-btn" aria-label="Remove item">Remove</button>
    `;
    
    cartItemsDiv.appendChild(div);
    
    // Quantity controls
    const incBtn = div.querySelector('.inc');
    const decBtn = div.querySelector('.dec');
    const removeBtn = div.querySelector('.remove-item-btn');
    
    incBtn.addEventListener('click', () => {
      item.qty = (item.qty || 1) + 1;
      saveCart();
      renderCart();
    });
    
    decBtn.addEventListener('click', () => {
      if (item.qty > 1) {
        item.qty--;
      } else {
        cart = cart.filter((_, i) => i !== index);
      }
      saveCart();
      renderCart();
    });
    
    removeBtn.addEventListener('click', () => {
      cart = cart.filter((_, i) => i !== index);
      saveCart();
      renderCart();
    });
  });
  
  // Update summary
  document.getElementById('subtotal').textContent = `$${subtotal.toFixed(2)}`;
  document.getElementById('total').textContent = `$${subtotal.toFixed(2)}`;
}

checkoutBtn.addEventListener('click', () => {
  if (cart.length === 0) return;
  
  let msg = 'Leyr. Order:%0A%0A';
  let total = 0;
  
  cart.forEach(item => {
    const itemTotal = (item.price || 0) * (item.qty || 1);
    total += itemTotal;
    msg += `${item.name} x${item.qty || 1} - $${itemTotal.toFixed(2)}%0A`;
  });
  
  msg += `%0ATotal: $${total.toFixed(2)}`;
  
  window.open(`https://wa.me/?text=${msg}`, '_blank');
});

// Initial render
renderCart();
</script>

<section class="contact-section">
  <div class="contact-container">
    <h2>Contactează-ne</h2>
    <div class="contact-info">
      <a href="https://instagram.com/leyr" target="_blank" class="contact-link">
        <span class="contact-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="2" y="2" width="20" height="20" rx="5" stroke="currentColor" stroke-width="2" fill="none"/>
            <circle cx="12" cy="12" r="4" stroke="currentColor" stroke-width="2" fill="none"/>
            <circle cx="17.5" cy="6.5" r="1.5" fill="currentColor"/>
          </svg>
        </span>
        <span>Instagram</span>
      </a>
      <a href="https://wa.me/40712345678" target="_blank" class="contact-link">
        <span class="contact-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
          </svg>
        </span>
        <span>WhatsApp</span>
      </a>
      <a href="https://facebook.com/leyr" target="_blank" class="contact-link">
        <span class="contact-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
          </svg>
        </span>
        <span>Facebook</span>
      </a>
      <a href="https://tiktok.com/@leyr" target="_blank" class="contact-link">
        <span class="contact-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"/>
          </svg>
        </span>
        <span>TikTok</span>
      </a>
    </div>
  </div>
</section>

<footer>
  <p>&copy; 2025 Leyr. All rights reserved.</p>
</footer>

</body>
</html>
